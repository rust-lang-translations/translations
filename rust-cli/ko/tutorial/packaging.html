<!DOCTYPE HTML>
<html lang="ko" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Rust 도구 패키징 및 배포 - Command Line Applications in Rust</title>


        <!-- Custom HTML head -->

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-L455DH98TK"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-L455DH98TK');
        </script>
        
        
        <script>
            (function () {
                // See these pages for details:
                // https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls
                // https://developers.google.com/search/docs/crawling-indexing/javascript/javascript-seo-basics
        
                function gen_canonical_href(lang) {
        
                    let base = "https://rust-lang-translations.org/rust-cli";
        
                    let canonical_href;
                    if (lang == "en") {
                        canonical_href = `${base}/tutorial/packaging.md`;
                    } else {
                        canonical_href = `${base}/${lang}/tutorial/packaging.md`;
                    }
                    canonical_href = canonical_href.slice(0, -"md".length) + "html";
                    if (canonical_href.endsWith("/index.html")) {
                        canonical_href = canonical_href.slice(0, -"index.html".length);
                    }
                    return canonical_href;
                }
        
                const canonical_href = gen_canonical_href("ko");

                let link = document.createElement("link");
                link.rel = "canonical";
                link.href = canonical_href;
                document.head.appendChild(link);
        
        
                const langs = ["en"  , "ko" ];
        
                for (const lang of langs) {
                    const canonical_href = gen_canonical_href(lang);
        
                    let link = document.createElement("link");
                    link.rel = "alternate";
                    link.hreflang = lang;
                    link.href = canonical_href;
                    document.head.appendChild(link);
                }
            })()
        </script>
        

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/special-content.css">
        <link rel="stylesheet" href="../theme/language-picker.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Command Line Applications in Rust</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang-translations/project" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rust-도구-패키징-및-배포"><a class="header" href="#rust-도구-패키징-및-배포">Rust 도구 패키징 및 배포</a></h1>
<p>프로그램이 다른 사람들이 사용할 준비가 되었다고 확신한다면 패키징하고 출시할 시간입니다!</p>
<p>There are a few approaches, and we’ll look at three of them from quickest to set up to most convenient for users.</p>
<h2 id="가장-빠른-방법-cargo-publish"><a class="header" href="#가장-빠른-방법-cargo-publish">가장 빠른 방법: <code>cargo publish</code></a></h2>
<p>The easiest way to publish your app is with cargo. Do you remember how we added external dependencies to our project? Cargo downloaded them from its default crate registry: <a href="https://crates.io/">crates.io</a>. With <code>cargo publish</code>, you can publish crates to <a href="https://crates.io/">crates.io</a>, and this works for all crates, including those with binary targets.</p>
<p>Publishing a crate to <a href="https://crates.io/">crates.io</a> can be done in a few steps. First, if you haven’t already, create an account on <a href="https://crates.io/">crates.io</a>, which is done by authorizing you on GitHub, so you’ll need to have a GitHub account and be logged in there. Second, you log in using cargo on your local machine. For that, go to your <a href="https://crates.io/me">crates.io account page</a>, create a new token, and run <code>cargo login &lt;your-new-token&gt;</code>. You only need to do this once per computer. You can learn more about this in cargo’s <a href="https://doc.rust-lang.org/1.39.0/cargo/reference/publishing.html">publishing guide</a>.</p>
<p>Now that cargo and crates.io know you, you are ready to publish crates. Before you hastily go ahead and publish a new crate version, it’s a good idea to open your <code>Cargo.toml</code> once more and make sure you added the necessary metadata. You can find all the possible fields you can set in the documentation for <a href="https://doc.rust-lang.org/1.39.0/cargo/reference/manifest.html">cargo’s manifest format</a>. Here’s a quick overview of some common entries:</p>
<pre><code class="language-toml">[package]
name = "grrs"
version = "0.1.0"
authors = ["Your Name &lt;your@email.com&gt;"]
license = "MIT OR Apache-2.0"
description = "A tool to search files"
readme = "README.md"
homepage = "https://github.com/you/grrs"
repository = "https://github.com/you/grrs"
keywords = ["cli", "search", "demo"]
categories = ["command-line-utilities"]
</code></pre>
<aside class="note">
<p><strong>Note:</strong> This example includes the mandatory license field with a common choice for Rust projects: The same license that is used for the compiler itself. It also refers to a <code>README.md</code> file. It should include a quick description of what your project is about and will be included not only on the crates.io page of your crate, but GitHub shows it by default on repository pages.</p>
</aside>
<h3 id="cratesio에서-바이너리를-설치하는-방법"><a class="header" href="#cratesio에서-바이너리를-설치하는-방법">crates.io에서 바이너리를 설치하는 방법</a></h3>
<p>We’ve seen how to publish a crate to crates.io, and you might be wondering how to install it. In contrast to libraries, which cargo will download and compile for you when you run <code>cargo build</code> or a similar command, you’ll need to tell it to explicitly install binaries.</p>
<p>This is done using <code>cargo install &lt;crate-name&gt;</code>. It will download the crate by default, compile all the binary targets it contains (in “release” mode, so it might take a while) and copy them into the <code>~/.cargo/bin/</code> directory. Make sure that your shell knows to look there for binaries!</p>
<p>git 리포지토리에서 크레이트를 설치하고, 크레이트의 특정 바이너리만 설치하고, 설치할 대체 디렉토리를 지정할 수도 있습니다. 자세한 내용은 <code>cargo install --help</code>를 참조하세요.</p>
<h3 id="사용-시기"><a class="header" href="#사용-시기">사용 시기</a></h3>
<p><code>cargo install</code> is a simple way to install a binary crate. It’s very convenient for Rust developers to use but has some significant downsides: Since it will always compile your source from scratch, users of your tool will need to have Rust, cargo, and all other system dependencies that your project requires installed on their machine. Compiling large Rust codebases can take some time.</p>
<p>It’s best to use this for distributing tools that are targeted at other Rust developers. For example, a lot of cargo subcommands like <code>cargo-tree</code> or <code>cargo-outdated</code> can be installed with it.</p>
<h2 id="바이너리-배포"><a class="header" href="#바이너리-배포">바이너리 배포</a></h2>
<p>Rust is a language that compiles to native code and statically links all dependencies by default. When you run <code>cargo build</code> on your project that contains a binary called <code>grrs</code>, you’ll end up with a binary file called <code>grrs</code>. Try it out! Using <code>cargo build</code>, it’ll be <code>target/debug/grrs</code>, and when you run <code>cargo build --release</code>, it’ll be <code>target/release/grrs</code>. Unless you use crates that explicitly need external libraries installed on the target system (like using the system’s version of OpenSSL), this binary will only depend on common system libraries. That means, you take that one file, send it to people running the same operating system as you, and they’ll be able to run it.</p>
<p>이것은 이미 매우 강력합니다! 방금 본 <code>cargo install</code>의 두 가지 단점을 해결합니다. 사용자 컴퓨터에 Rust를 설치할 필요가 없으며 컴파일하는 데 1분이 걸리는 대신 즉시 바이너리를 실행할 수 있습니다.</p>
<p>As we’ve seen, <code>cargo build</code> <em>already</em> builds binaries for us. The issue is that those are not guaranteed to work on all platforms. If you run <code>cargo build</code> on your Windows machine, you won’t get a binary that works on a Mac by default. Is there a way to generate these binaries for all of the target platforms automatically?</p>
<h3 id="ci에서-바이너리-릴리스-빌드"><a class="header" href="#ci에서-바이너리-릴리스-빌드">CI에서 바이너리 릴리스 빌드</a></h3>
<p>If your tool is open sourced and hosted on GitHub, it’s quite easy to set up a free CI (continuous integration) service like <a href="https://travis-ci.com/">Travis CI</a>. There are other services that offer this functionality, but Travis is very popular. This runs setup commands in a virtual machine each time you push changes to your repository. What those commands are, and the types of machines they run on, is configurable. For example, a good idea is to run <code>cargo test</code> on a machine with Rust and some common build tools installed. If this fails, you know there are issues in the most recent changes.</p>
<p>We can also use this to build binaries and upload them to GitHub! If we run <code>cargo build --release</code> and upload the binary somewhere, we should be all set, right? Not quite. We still need to make sure the binaries we build are compatible with as many systems as possible. For example, on Linux we can compile for the current system or the <code>x86_64-unknown-linux-musl</code> target and not depend on default system libraries. On macOS, we can set <code>MACOSX_DEPLOYMENT_TARGET</code> to <code>10.7</code> to only depend on system features present in versions 10.7 and older.</p>
<p>You can see one example of building binaries using this approach <a href="https://github.com/rustwasm/wasm-pack/blob/51e6351c28fbd40745719e6d4a7bf26dadd30c85/.travis.yml#L74-L91">here</a> for Linux and macOS and <a href="https://github.com/rustwasm/wasm-pack/blob/51e6351c28fbd40745719e6d4a7bf26dadd30c85/.appveyor.yml">here</a> for Windows using AppVeyor.</p>
<p>Another way is to use pre-built (i.e. Docker) images that contain all the tools we need to build binaries. This allows us to easily target more exotic platforms as well. The <a href="https://github.com/japaric/trust">trust</a> project contains scripts that you can include in your project and instructions on how to set this up. It also includes support for Windows using AppVeyor.</p>
<p>If you’d rather set this up locally and generate the release files on your own machine, have a look at <a href="https://github.com/japaric/trust">trust</a>. It uses <a href="https://github.com/rust-embedded/cross">cross</a> internally, which works similar to cargo but forwards commands to a cargo process inside a Docker container. The definitions of the images are also available in <a href="https://github.com/rust-embedded/cross">cross’ repository</a>.</p>
<h3 id="이러한-바이너리를-설치하는-방법"><a class="header" href="#이러한-바이너리를-설치하는-방법">이러한 바이너리를 설치하는 방법</a></h3>
<p>You point your users to your release page that might look something <a href="https://github.com/rustwasm/wasm-pack/releases/tag/v0.5.1">like this one</a>, and they can download the artifacts we’ve just created. The release artifacts we’ve generated are nothing special. They are just archive files that contain our binaries! This means that users of your tool can download them with their browser, extract them (often automatically), and copy the binaries to a place they like.</p>
<p>This does require some experience with manually installing programs, so you want to add a section to your README file on how to install this program.</p>
<aside class="note">
<p><strong>Note:</strong> If you use <a href="https://github.com/japaric/trust">trust</a> to build your binaries and add them to GitHub releases, you can also tell people to run <code>curl -LSfs https://japaric.github.io/trust/install.sh | sh -s -- --git your-name/repo-name</code> if you think that makes it easier.</p>
</aside>
<h3 id="사용-시기-1"><a class="header" href="#사용-시기-1">사용 시기</a></h3>
<p>Having binary releases is a good idea in general. There’s hardly any downside to it. It does not solve the problem of users having to manually install and update your tools, but they can quickly get the latest release’s version without the need to install Rust.</p>
<h3 id="바이너리-외에-무엇을-패키징해야-할까요"><a class="header" href="#바이너리-외에-무엇을-패키징해야-할까요">바이너리 외에 무엇을 패키징해야 할까요</a></h3>
<p>Right now, when a user downloads our release builds, they will get a <code>.tar.gz</code> file that only contains binary files. In our example project, they will just get a single <code>grrs</code> file they can run, but there are more files we already have in our repository that they might want to have. The README file that tells them how to use this tool and the license file(s), for example. Since we already have them, they are easy to add.</p>
<p>There are more interesting files that make sense, especially for command-line tools. How about we ship a man page in addition to that README file and config files that add completions of the possible flags to your shell? You can write these by hand, but <em>clap</em>, the argument parsing library we use (which clap builds upon) has a way to generate all these files for us. See <a href="../in-depth/docs.html">this in-depth chapter</a> for more details.</p>
<h2 id="앱을-패키지-리포지토리에-넣기"><a class="header" href="#앱을-패키지-리포지토리에-넣기">앱을 패키지 리포지토리에 넣기</a></h2>
<p>Both approaches we’ve seen so far are not how you typically install software on your machine, especially for command-line tools that you install using global package managers on most operating systems. The advantages for users are quite obvious: There is no need to think about how to install your program if it can be installed the same way as they install other tools. These package managers also allow users to update their programs when a new version is available.</p>
<p>Sadly, supporting different systems means you’ll have to look at how these different systems work. For some, it might be as easy as adding a file to your repository (e.g. adding a Formula file like <a href="https://github.com/BurntSushi/ripgrep/blob/31adff6f3c4bfefc9e77df40871f2989443e6827/pkg/brew/ripgrep-bin.rb">this</a> for macOS’s <code>brew</code>), but for others, you’ll often need to send in patches yourself and add your tool to their repositories. There are helpful tools like <a href="https://crates.io/crates/cargo-bundle">cargo-bundle</a>, <a href="https://crates.io/crates/cargo-deb">cargo-deb</a>, and <a href="https://crates.io/crates/cargo-aur">cargo-aur</a>, but describing how they work and how to correctly package your tool for those different systems is beyond the scope of this chapter.</p>
<p>대신 Rust로 작성되었고 많은 다른 패키지 관리자에서 사용할 수 있는 도구를 살펴보겠습니다.</p>
<h3 id="예-ripgrep"><a class="header" href="#예-ripgrep">예: ripgrep</a></h3>
<p><a href="https://github.com/BurntSushi/ripgrep">ripgrep</a>은 <code>grep</code>/<code>ack</code>/<code>ag</code>의 대안이며 Rust로 작성되었습니다. 매우 성공적이며 많은 운영 체제용으로 패키징되었습니다. README의 <a href="https://github.com/BurntSushi/ripgrep/tree/31adff6f3c4bfefc9e77df40871f2989443e6827#installation">“설치” 섹션</a>을 살펴보세요!</p>
<p>Note that it lists a few different options on how you can install it: It starts with a link to the GitHub releases, which contain the binaries so that you can download them directly, it lists how to install it using a bunch of different package managers, and you can also install it using <code>cargo install</code>.</p>
<p>This seems like a very good idea. Don’t pick and choose one of the approaches presented here. Start with <code>cargo install</code> and add binary releases before finally distributing your tool using system package managers.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../tutorial/testing.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../in-depth/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../tutorial/testing.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../in-depth/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/language-picker.js"></script>


    </div>
    </body>
</html>
