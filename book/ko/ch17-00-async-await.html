<!DOCTYPE HTML>
<html lang="ko" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>비동기 프로그래밍의 기초: Async, Await, Future, Stream - The Rust Programming Language</title>


        <!-- Custom HTML head -->

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-L455DH98TK"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-L455DH98TK');
        </script>
        
        
        <script>
            (function () {
                // See these pages for details:
                // https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls
                // https://developers.google.com/search/docs/crawling-indexing/javascript/javascript-seo-basics
        
                function gen_canonical_href(lang) {
        
                    let base = "https://rust-lang-translations.org/book";
        
                    let canonical_href;
                    if (lang == "en") {
                        canonical_href = `${base}/ch17-00-async-await.md`;
                    } else {
                        canonical_href = `${base}/${lang}/ch17-00-async-await.md`;
                    }
                    canonical_href = canonical_href.slice(0, -"md".length) + "html";
                    if (canonical_href.endsWith("/index.html")) {
                        canonical_href = canonical_href.slice(0, -"index.html".length);
                    }
                    return canonical_href;
                }
        
                const canonical_href = gen_canonical_href("ko");

                let link = document.createElement("link");
                link.rel = "canonical";
                link.href = canonical_href;
                document.head.appendChild(link);
        
        
                const langs = ["en"  , "ja"  , "ru"  , "ko" ];
        
                for (const lang of langs) {
                    const canonical_href = gen_canonical_href(lang);
        
                    let link = document.createElement("link");
                    link.rel = "alternate";
                    link.hreflang = lang;
                    link.href = canonical_href;
                    document.head.appendChild(link);
                }
            })()
        </script>
        

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="ferris.css">
        <link rel="stylesheet" href="theme/2018-edition.css">
        <link rel="stylesheet" href="theme/semantic-notes.css">
        <link rel="stylesheet" href="theme/listing.css">
        <link rel="stylesheet" href="theme/language-picker.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rust Programming Language</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang-translations/project" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="비동기-프로그래밍의-기초-async-await-future-stream"><a class="header" href="#비동기-프로그래밍의-기초-async-await-future-stream">비동기 프로그래밍의 기초: Async, Await, Future, Stream</a></h1>
<p>우리가 컴퓨터에게 요청하는 많은 작업은 완료하는 데 시간이 걸릴 수 있습니다. 오래 걸리는 프로세스가 완료되기를 기다리는 동안 다른 작업을 할 수 있다면 좋을 것입니다. 현대 컴퓨터는 한 번에 하나 이상의 작업을 수행하기 위한 두 가지 기술인 병렬성과 동시성을 제공합니다. 하지만 병렬 또는 동시 작업을 포함하는 프로그램을 작성하기 시작하면, 작업이 시작된 순서대로 순차적으로 완료되지 않을 수 있는 <em>비동기 프로그래밍</em> 고유의 새로운 과제에 빠르게 직면하게 됩니다. 이 장은 16장의 병렬성 및 동시성을 위한 스레드 사용을 바탕으로 비동기 프로그래밍에 대한 대안적 접근 방식인 러스트의 Future, Stream, 이를 지원하는 <code>async</code> 및 <code>await</code> 문법, 그리고 비동기 작업 간의 관리 및 조정을 위한 도구를 소개합니다.</p>
<p>예를 들어보겠습니다. 가족 축하 행사를 촬영한 비디오를 내보내기(export)한다고 가정해 봅시다. 이 작업은 몇 분에서 몇 시간까지 걸릴 수 있습니다. 비디오 내보내기는 가능한 한 많은 CPU와 GPU 파워를 사용할 것입니다. 만약 여러분에게 CPU 코어가 하나뿐이고 운영 체제가 내보내기가 완료될 때까지 일시 중지하지 않는다면—즉, 내보내기를 <em>동기적으로</em> 실행한다면—그 작업이 실행되는 동안 컴퓨터에서 다른 어떤 것도 할 수 없을 것입니다. 그것은 꽤 실망스러운 경험이 될 것입니다. 다행히도, 여러분의 컴퓨터 운영 체제는 내보내기 작업을 자주, 보이지 않게 중단시켜 여러분이 동시에 다른 작업을 할 수 있도록 할 수 있으며, 실제로 그렇게 합니다.</p>
<p>이제 다른 사람이 공유한 비디오를 다운로드한다고 가정해 봅시다. 이 또한 시간이 걸릴 수 있지만 CPU 시간을 많이 차지하지는 않습니다. 이 경우, CPU는 데이터가 네트워크로부터 도착할 때까지 기다려야 합니다. 데이터가 도착하기 시작하면 읽기 시작할 수 있지만, 모든 데이터가 나타날 때까지 시간이 좀 걸릴 수 있습니다. 데이터가 모두 존재하더라도 비디오가 꽤 크다면 모두 로드하는 데 적어도 1~2초가 걸릴 수 있습니다. 별것 아닌 것처럼 들릴 수 있지만, 초당 수십억 번의 연산을 수행할 수 있는 현대 프로세서에게는 매우 긴 시간입니다. 다시 말하지만, 운영 체제는 네트워크 호출이 완료되기를 기다리는 동안 CPU가 다른 작업을 수행할 수 있도록 프로그램을 보이지 않게 중단시킬 것입니다.</p>
<p>비디오 내보내기는 <em>CPU-bound</em> 또는 <em>compute-bound</em>(계산 중심) 작업의 예입니다. 이는 CPU나 GPU 내에서 컴퓨터의 잠재적 데이터 처리 속도와 그 속도 중 얼마나 많은 부분을 작업에 할당할 수 있는지에 의해 제한됩니다. 비디오 다운로드는 <em>IO-bound</em>(입출력 중심) 작업의 예입니다. 왜냐하면 컴퓨터의 <em>입력 및 출력</em> 속도에 의해 제한되기 때문입니다. 데이터가 네트워크를 통해 전송될 수 있는 속도만큼만 빠르게 진행될 수 있습니다.</p>
<p>이 두 예제 모두에서 운영 체제의 보이지 않는 인터럽트는 일종의 동시성을 제공합니다. 하지만 그 동시성은 전체 프로그램 수준에서만 발생합니다: 운영 체제는 다른 프로그램이 작업을 수행할 수 있도록 한 프로그램을 중단시킵니다. 많은 경우, 우리는 운영 체제보다 훨씬 더 세밀한 수준에서 우리 프로그램을 이해하기 때문에, 운영 체제가 볼 수 없는 동시성 기회를 발견할 수 있습니다.</p>
<p>예를 들어, 파일 다운로드를 관리하는 도구를 만들고 있다면, 하나의 다운로드를 시작해도 UI가 잠기지 않도록 프로그램을 작성할 수 있어야 하며, 사용자는 동시에 여러 다운로드를 시작할 수 있어야 합니다. 하지만 네트워크와 상호 작용하기 위한 많은 운영 체제 API는 <em>블로킹(blocking)</em> 방식입니다; 즉, 처리 중인 데이터가 완전히 준비될 때까지 프로그램의 진행을 차단합니다.</p>
<blockquote>
<p>Note: This is how <em>most</em> function calls work, if you think about it. However, the term <em>blocking</em> is usually reserved for function calls that interact with files, the network, or other resources on the computer, because those are the cases where an individual program would benefit from the operation being <em>non</em>-blocking.</p>
</blockquote>
<p>각 파일을 다운로드하기 위해 전용 스레드를 생성함으로써 메인 스레드가 차단되는 것을 피할 수 있습니다. 하지만 그러한 스레드의 오버헤드는 결국 문제가 될 것입니다. 애초에 호출이 차단되지 않는 것이 바람직할 것입니다. 또한 다음과 같이 블로킹 코드에서 사용하는 것과 같은 직접적인 스타일로 작성할 수 있다면 더 좋을 것입니다:</p>
<pre><code class="language-rust ignore does_not_compile">let data = fetch_data_from(url).await;
println!("{data}");</code></pre>
<p>이것이 바로 러스트의 <em>async</em>(_asynchronous_의 줄임말) 추상화가 우리에게 제공하는 것입니다. 이 장에서는 다음 주제들을 다루며 비동기에 대한 모든 것을 배울 것입니다:</p>
<ul>
<li>러스트의 <code>async</code>와 <code>await</code> 문법을 사용하는 방법</li>
<li>16장에서 살펴본 것과 동일한 과제를 해결하기 위해 비동기 모델을 사용하는 방법</li>
<li>멀티스레딩과 비동기가 어떻게 상호 보완적인 솔루션을 제공하며, 많은 경우에 이들을 결합할 수 있는지</li>
</ul>
<p>하지만 실제로 비동기가 어떻게 작동하는지 보기 전에, 병렬성과 동시성의 차이에 대해 논의하기 위해 잠시 우회해야 합니다.</p>
<h3 id="병렬성과-동시성"><a class="header" href="#병렬성과-동시성">병렬성과 동시성</a></h3>
<p>지금까지 우리는 병렬성과 동시성을 거의 상호 교환 가능한 것으로 취급해 왔습니다. 이제 작업을 시작하면서 그 차이가 드러날 것이므로, 이들을 더 정확하게 구별해야 합니다.</p>
<p>팀이 소프트웨어 프로젝트의 작업을 나누는 다양한 방법을 생각해 보세요. 한 구성원에게 여러 작업을 할당하거나, 각 구성원에게 하나의 작업을 할당하거나, 두 가지 접근 방식을 혼합하여 사용할 수 있습니다.</p>
<p>개인이 여러 다른 작업 중 어느 하나도 완료되지 않은 상태에서 여러 작업을 수행할 때, 이것이 _동시성(concurrency)_입니다. 컴퓨터에 두 개의 다른 프로젝트를 체크아웃해 두고, 한 프로젝트가 지루해지거나 막히면 다른 프로젝트로 전환할 수 있습니다. 여러분은 한 명뿐이므로 정확히 동시에 두 작업 모두 진전을 이룰 수는 없지만, 멀티태스킹을 통해 한 번에 하나씩 작업을 전환하며 진전을 이룰 수 있습니다(그림 17-1 참조).</p>
<figure>
<img src="img/trpl17-01.svg" class="center" alt="A diagram with boxes labeled Task A and Task B, with diamonds in them representing subtasks. There are arrows pointing from A1 to B1, B1 to A2, A2 to B2, B2 to A3, A3 to A4, and A4 to B3. The arrows between the subtasks cross the boxes between Task A and Task B." />
<figcaption>Figure 17-1: A concurrent workflow, switching between Task A and Task B</figcaption>
</figure>
<p>팀이 각 구성원에게 하나의 작업을 맡겨 혼자서 작업하게 함으로써 작업 그룹을 분할할 때, 이것이 _병렬성(parallelism)_입니다. 팀의 각 사람은 정확히 동시에 진전을 이룰 수 있습니다(그림 17-2 참조).</p>
<figure>
<img src="img/trpl17-02.svg" class="center" alt="A diagram with boxes labeled Task A and Task B, with diamonds in them representing subtasks. There are arrows pointing from A1 to A2, A2 to A3, A3 to A4, B1 to B2, and B2 to B3. No arrows cross between the boxes for Task A and Task B." />
<figcaption>Figure 17-2: A parallel workflow, where work happens on Task A and Task B independently</figcaption>
</figure>
<p>이 두 작업 흐름 모두에서, 서로 다른 작업 간의 조정이 필요할 수 있습니다. 아마도 여러분은 한 사람에게 할당된 작업이 다른 모든 사람의 작업과 완전히 독립적이라고 <em>생각했을</em> 수 있지만, 실제로는 팀의 다른 사람이 먼저 작업을 완료해야 할 수도 있습니다. 작업의 일부는 병렬로 수행될 수 있지만, 그 중 일부는 실제로 _직렬(serial)_이었습니다: 그림 17-3과 같이 한 작업이 끝난 후에 다른 작업이 이어지는 시리즈로만 일어날 수 있습니다.</p>
<figure>
<img src="img/trpl17-03.svg" class="center" alt="A diagram with boxes labeled Task A and Task B, with diamonds in them representing subtasks. There are arrows pointing from A1 to A2, A2 to a pair of thick vertical lines like a “pause” symbol, from that symbol to A3, B1 to B2, B2 to B3, which is below that symbol, B3 to A3, and B3 to B4." />
<figcaption>Figure 17-3: A partially parallel workflow, where work happens on Task A and Task B independently until Task A3 is blocked on the results of Task B3.</figcaption>
</figure>
<p>마찬가지로, 자신의 작업 중 하나가 다른 작업에 의존한다는 것을 깨달을 수도 있습니다. 이제 여러분의 동시 작업도 직렬 작업이 되었습니다.</p>
<p>병렬성과 동시성은 서로 교차할 수도 있습니다. 동료가 여러분의 작업 중 하나를 완료할 때까지 막혀 있다는 것을 알게 되면, 아마도 동료의 "차단을 해제"하기 위해 그 작업에 모든 노력을 집중할 것입니다. 여러분과 동료는 더 이상 병렬로 작업할 수 없으며, 여러분 또한 자신의 작업에 대해 더 이상 동시에 작업할 수 없습니다.</p>
<p>소프트웨어와 하드웨어에서도 동일한 기본 역학이 작용합니다. 단일 CPU 코어가 있는 머신에서 CPU는 한 번에 하나의 작업만 수행할 수 있지만, 여전히 동시에 작동할 수 있습니다. 스레드, 프로세스, 비동기와 같은 도구를 사용하여 컴퓨터는 한 활동을 일시 중지하고 다른 활동으로 전환한 후 결국 다시 첫 번째 활동으로 돌아올 수 있습니다. 다중 CPU 코어가 있는 머신에서는 병렬로 작업을 수행할 수도 있습니다. 한 코어가 한 작업을 수행하는 동안 다른 코어가 완전히 무관한 작업을 수행할 수 있으며, 이러한 작업은 실제로 동시에 일어납니다.</p>
<p>러스트에서 비동기로 작업할 때, 우리는 항상 동시성을 다루고 있습니다. 하드웨어, 운영 체제, 그리고 우리가 사용하는 비동기 런타임(비동기 런타임에 대해서는 잠시 후에 더 자세히 다루겠습니다)에 따라, 그 동시성은 내부적으로 병렬성을 사용할 수도 있습니다.</p>
<p>이제 러스트에서 비동기 프로그래밍이 실제로 어떻게 작동하는지 자세히 살펴봅시다.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch16-04-extensible-concurrency-sync-and-send.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch17-01-futures-and-syntax.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch16-04-extensible-concurrency-sync-and-send.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch17-01-futures-and-syntax.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="ferris.js"></script>
        <script src="theme/language-picker.js"></script>


    </div>
    </body>
</html>
