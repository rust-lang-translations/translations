<!DOCTYPE HTML>
<html lang="ko" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>팬텀 데이터 - The Rustonomicon</title>


        <!-- Custom HTML head -->

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-L455DH98TK"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-L455DH98TK');
        </script>
        
        
        <script>
            (function () {
                // See these pages for details:
                // https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls
                // https://developers.google.com/search/docs/crawling-indexing/javascript/javascript-seo-basics
        
                function gen_canonical_href(lang) {
        
                    let base = "https://rust-lang-translations.org/nomicon";
        
                    let canonical_href;
                    if (lang == "en") {
                        canonical_href = `${base}/phantom-data.md`;
                    } else {
                        canonical_href = `${base}/${lang}/phantom-data.md`;
                    }
                    canonical_href = canonical_href.slice(0, -"md".length) + "html";
                    if (canonical_href.endsWith("/index.html")) {
                        canonical_href = canonical_href.slice(0, -"index.html".length);
                    }
                    return canonical_href;
                }
        
                const canonical_href = gen_canonical_href("ko");

                let link = document.createElement("link");
                link.rel = "canonical";
                link.href = canonical_href;
                document.head.appendChild(link);
        
        
                const langs = ["en"  , "ko" ];
        
                for (const lang of langs) {
                    const canonical_href = gen_canonical_href(lang);
        
                    let link = document.createElement("link");
                    link.rel = "alternate";
                    link.hreflang = lang;
                    link.href = canonical_href;
                    document.head.appendChild(link);
                }
            })()
        </script>
        

        <meta name="description" content="The Dark Arts of Advanced and Unsafe Rust Programming">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/nomicon.css">
        <link rel="stylesheet" href="theme/language-picker.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Rustonomicon</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang-translations/project" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="팬텀-데이터"><a class="header" href="#팬텀-데이터">팬텀 데이터</a></h1>
<p>unsafe 코드로 작업할 때, 타입이나 수명이 구조체와 논리적으로 연관되어 있지만 실제로는 필드의 일부가 아닌 상황에 처할 때가 많습니다. 이는 수명에서 가장 흔히 발생합니다. 예를 들어, <code>&amp;'a [T]</code>에 대한 <code>Iter</code>는 (대략) 다음과 같이 정의됩니다:</p>
<pre><pre class="playground"><code class="language-rust compile_fail edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Iter&lt;'a, T: 'a&gt; {
    ptr: *const T,
    end: *const T,
}
<span class="boring">}</span></code></pre></pre>
<p>하지만 <code>'a</code>가 구조체 본문 내에서 사용되지 않기 때문에, 이것은 _무한(unbounded)_합니다. <a href="https://rust-lang.github.io/rfcs/0738-variance.html#the-corner-case-unused-parameters-and-parameters-that-are-only-used-unsafely">이것이 역사적으로 일으킨 문제들 때문에</a>, 구조체 정의에서 무한한 수명과 타입은 _금지_됩니다. 따라서 우리는 어떤 식으로든 본문에서 이 타입들을 참조해야 합니다. 이를 올바르게 하는 것은 올바른 공변성(variance)과 드롭 검사를 위해 필수적입니다.</p>
<p>우리는 특별한 마커 타입인 <code>PhantomData</code>를 사용하여 이 작업을 수행합니다. <code>PhantomData</code>는 공간을 차지하지 않지만, 정적 분석을 목적으로 주어진 타입의 필드를 시뮬레이션합니다. 이는 타입 시스템에 원하는 공변성 종류를 명시적으로 알려주는 것보다 에러가 덜 발생한다고 간주되며, 동시에 오토 트레잇(auto traits)이나 드롭 검사에 필요한 정보와 같은 다른 유용한 것들도 제공합니다.</p>
<p><code>Iter</code>는 논리적으로 여러 개의 <code>&amp;'a T</code>를 포함하므로, 이것이 바로 우리가 <code>PhantomData</code>에게 시뮬레이션하라고 지시하는 것입니다:</p>
<pre><pre class="playground"><code class="language-rust edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::marker;

struct Iter&lt;'a, T: 'a&gt; {
    ptr: *const T,
    end: *const T,
    _marker: marker::PhantomData&lt;&amp;'a T&gt;,
}
<span class="boring">}</span></code></pre></pre>
<p>이게 전부입니다. 수명은 제한될 것이고, 여러분의 반복자(iterator)는 <code>'a</code>와 <code>T</code>에 대해 공변적이 될 것입니다. 모든 것이 그냥 잘 작동합니다.</p>
<h2 id="제네릭-매개변수와-드롭-검사"><a class="header" href="#제네릭-매개변수와-드롭-검사">제네릭 매개변수와 드롭 검사</a></h2>
<p>과거에는 고려해야 할 또 다른 사항이 있었습니다.</p>
<p>이 문서 자체에서도 예전에는 다음과 같이 말했습니다:</p>
<blockquote>
<p>또 다른 중요한 예는 <code>Vec</code>인데, 이는 (대략) 다음과 같이 정의됩니다:</p>
<pre><pre class="playground"><code class="language-rust edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Vec&lt;T&gt; {
    data: *const T, // 공변성을 위한 *const!
    len: usize,
    cap: usize,
}
<span class="boring">}</span></code></pre></pre>
<p>이전 예제와 달리, 모든 것이 우리가 원하는 대로인 것처럼 <em>보입니다</em>. <code>Vec</code>으로의 모든 제네릭 인자가 적어도 하나의 필드에 나타납니다. 준비 끝!</p>
<p>아니요.</p>
<p>드롭 검사기는 관대하게도 <code>Vec&lt;T&gt;</code>가 <code>T</code> 타입의 어떤 값도 소유하지 않는다고 판단할 것입니다. 이는 결국 드롭 검사 건전성을 판단할 때 <code>Vec</code>의 소멸자에서 <code>T</code>를 드롭하는 것에 대해 걱정할 필요가 없다는 결론으로 이어집니다. 이는 다시 사람들이 <code>Vec</code>의 소멸자를 사용해 불건전성(unsoundness)을 만들어낼 수 있게 허용하게 됩니다.</p>
<p>우리가 <code>T</code> 타입의 값을 <em>실제로</em> 소유하고 있으며, 따라서 <em>우리가</em> 드롭될 때 일부 <code>T</code>들을 드롭할 수 있다는 것을 드롭 검사기에게 알리기 위해서는, 정확히 그 사실을 명시하는 추가적인 <code>PhantomData</code>를 더해야 합니다:</p>
<pre><pre class="playground"><code class="language-rust edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::marker;

struct Vec&lt;T&gt; {
    data: *const T, // 공변성을 위한 *const!
    len: usize,
    cap: usize,
    _owns_T: marker::PhantomData&lt;T&gt;,
}
<span class="boring">}</span></code></pre></pre>
</blockquote>
<p>하지만 <a href="https://rust-lang.github.io/rfcs/1238-nonparametric-dropck.html">RFC 1238</a> 이후로, <strong>이것은 더 이상 사실이 아니며 필요하지도 않습니다</strong>.</p>
<p>만약 여러분이 다음과 같이 작성한다면:</p>
<pre><pre class="playground"><code class="language-rust edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Vec&lt;T&gt; {
    data: *const T, // 공변성을 위한 `*const`!
    len: usize,
    cap: usize,
}

<span class="boring">#[cfg(any())]
</span>impl&lt;T&gt; Drop for Vec&lt;T&gt; { /* … */ }
<span class="boring">}</span></code></pre></pre>
<p>그 <code>impl&lt;T&gt; Drop for Vec&lt;T&gt;</code>의 존재로 인해 러스트는 해당 <code>Vec&lt;T&gt;</code>가 <code>T</code> 타입의 값을 _소유_한다고 간주하게 됩니다 (더 정확히는: <code>Drop</code> 구현에서 <code>T</code> 타입의 값을 사용할 수 있다고 봅니다). 따라서 러스트는 <code>Vec&lt;T&gt;</code>가 드롭될 때 그것들이 _댕글링(dangle)_되도록 허용하지 않을 것입니다.</p>
<p>타입에 이미 <code>Drop</code> 구현이 있는 경우, <strong>추가적인 <code>_owns_T: PhantomData&lt;T&gt;</code> 필드를 더하는 것은 드롭 검사 관점에서 <em>불필요하며</em> 아무것도 달성하지 못합니다</strong> (여전히 공변성과 오토 트레잇에는 영향을 미칩니다).</p>
<ul>
<li>(고급 엣지 케이스: <code>PhantomData</code>를 포함하는 타입에 <code>Drop</code> 구현이 전혀 없더라도, (드롭 글루가 있는 <em>다른</em> 필드를 가짐으로써) 여전히 드롭 글루가 있다면, 여기서 언급된 드롭 검사/<code>#[may_dangle]</code> 고려 사항들이 그대로 적용됩니다. <code>PhantomData&lt;T&gt;</code> 필드는 포함하는 타입이 스코프를 벗어날 때마다 <code>T</code>가 드롭 가능할 것을 요구하게 됩니다.)</li>
</ul>
<hr />
<p>하지만 이런 상황은 때때로 지나치게 제한적인 코드로 이어질 수 있습니다. 이것이 바로 표준 라이브러리가 이 문서 자체에서 경고했던 과거의 "검사되지 않는" 드롭 검사 동작으로 되돌아가기 위해 불안정하고 <code>unsafe</code>한 속성인 <code>#[may_dangle]</code> 속성을 사용하는 이유입니다.</p>
<h3 id="예외-표준-라이브러리와-불안정한-may_dangle의-특별한-사례"><a class="header" href="#예외-표준-라이브러리와-불안정한-may_dangle의-특별한-사례">예외: 표준 라이브러리와 불안정한 <code>#[may_dangle]</code>의 특별한 사례</a></h3>
<p>자신만의 라이브러리 코드만 작성한다면 이 섹션은 건너뛰어도 됩니다. 하지만 실제 <code>Vec</code> 정의에서 표준 라이브러리가 무엇을 하는지 궁금하다면, 건전성을 위해 여전히 <code>_owns_T: PhantomData&lt;T&gt;</code> 필드를 사용해야 한다는 것을 눈치챌 것입니다.</p>
<details><summary>Click here to see why</summary>
<p>다음 예제를 고려해 봅시다:</p>
<pre><pre class="playground"><code class="language-rust edition2024">fn main() {
    let mut v: Vec&lt;&amp;str&gt; = Vec::new();
    let s: String = "Short-lived".into();
    v.push(&amp;s);
    drop(s);
} // &lt;- 여기서 `v`가 드롭됩니다</code></pre></pre>
<p>고전적인 <code>impl&lt;T&gt; Drop for Vec&lt;T&gt; {</code> 정의를 사용하면, 위 코드는 <a href="https://rust.godbolt.org/z/ans15Kqz3">거부됩니다</a>.</p>
<p>실제로 이 경우 우리는 문자열에 대한 <code>'s</code> 수명을 가진 참조들의 벡터인 <code>Vec&lt;&amp;'s str&gt;</code>을 가지고 있습니다. 하지만 <code>let s: String</code>의 경우 <code>Vec</code>보다 먼저 드롭되므로, <code>Vec</code>이 드롭되고 <code>impl&lt;'s&gt; Drop for Vec&lt;&amp;'s str&gt;</code>이 사용될 시점에는 <code>'s</code>가 <strong>만료된(expired)</strong> 상태입니다.</p>
<p>이는 만약 그런 <code>Drop</code>이 사용된다면, 그것은 <em>만료된</em> 혹은 <em>댕글링된</em> 수명 <code>'s</code>를 다루게 된다는 것을 의미합니다. 하지만 이는 함수 시그니처에 포함된 모든 러스트 참조가 기본적으로 댕글링되지 않으며 역참조가 유효해야 한다는 러스트의 원칙에 어긋납니다.</p>
<p>이것이 러스트가 이 조각을 보수적으로 거부해야 하는 이유입니다.</p>
<p>그럼에도 불구하고 실제 <code>Vec</code>의 경우, <code>Drop</code> 구현은 <code>&amp;'s str</code>에 신경 쓰지 않습니다. 왜냐하면 <code>&amp;'s str</code>은 <em>자체적인 드롭 글루가 없기</em> 때문입니다. <code>Vec</code>은 오직 배후 버퍼를 해제하기만을 원할 뿐입니다.</p>
<p>달리 말하면, <code>Vec</code>을 특별 케이스로 처리하거나 <code>Vec</code>의 어떤 특별한 속성에 의존함으로써 위의 코드가 어떻게든 받아들여질 수 있다면 좋을 것입니다. 즉, <code>Vec</code>은 _드롭될 때 자신이 들고 있는 <code>&amp;'s str</code>들을 사용하지 않겠다고 약속_할 수 있을 것입니다.</p>
<p>이것이 바로 <code>#[may_dangle]</code>을 통해 표현할 수 있는 <code>unsafe</code>한 약속의 종류입니다:</p>
<pre><code class="language-rust  ignore">unsafe impl&lt;#[may_dangle] 's&gt; Drop for Vec&lt;&amp;'s str&gt; { /* … */ }</code></pre>
<p>또는 더 일반적으로는 다음과 같습니다:</p>
<pre><code class="language-rust  ignore">unsafe impl&lt;#[may_dangle] T&gt; Drop for Vec&lt;T&gt; { /* … */ }</code></pre>
<p>이는 드롭되는 인스턴스의 타입 매개변수가 댕글링되어서는 안 된다는 러스트 드롭 검사기의 보수적인 가정을 선택적으로 벗어나기(opt out) 위한 <code>unsafe</code>한 방법입니다.</p>
<p>표준 라이브러리에서처럼 이렇게 할 때는 <code>T</code> 자체가 드롭 글루(drop glue)를 가지고 있는 경우를 주의해야 합니다. 이 예시에서, <code>&amp;'s str</code>들을 <code>struct PrintOnDrop&lt;'s&gt;(&amp;'s str);</code>로 바꾼다고 상상해 보세요. 이 구조체는 <code>Drop</code> 구현 내에서 내부의 <code>&amp;'s str</code>을 역참조하여 화면에 출력할 것입니다.</p>
<p>실제로 <code>Drop for Vec&lt;T&gt;</code>는 배후 버퍼를 해제하기 전에, 각 <code>T</code> 아이템이 드롭 글루를 가지고 있다면 그것들을 전이적으로(transitively) 드롭해야 합니다. <code>PrintOnDrop&lt;'s&gt;</code>의 경우, <code>Drop for Vec&lt;PrintOnDrop&lt;'s&gt;&gt;</code>는 버퍼 해제 전에 <code>PrintOnDrop&lt;'s&gt;</code> 요소들을 전이적으로 드롭해야 함을 의미합니다.</p>
<p>따라서 우리가 <code>'s</code>가 <code>#[may_dangle]</code>하다고 말한 것은 지나치게 느슨한 표현이었습니다. 우리는 차라리 이렇게 말하고 싶을 것입니다: "<code>'s</code>는 전이적인 드롭 글루에 관여하지 않는 한 댕글링될 수 있다". 또는 더 일반적으로, "<code>T</code>는 전이적인 드롭 글루에 관여하지 않는 한 댕글링될 수 있다". 이 "예외의 예외"는 우리가 <strong><code>T</code>를 소유하고 있을 때</strong>마다 발생하는 만연한 상황입니다. 이것이 바로 러스트의 <code>#[may_dangle]</code>이 이러한 예외 상황을 알 만큼 충분히 똑똑한 이유이며, 따라서 <em>제네릭 매개변수가 구조체의 필드에 의해 소유되는 방식(owned fashion)으로 유지될 때</em> 이 기능은 비활성화될 것입니다.</p>
<p>그렇기 때문에 표준 라이브러리는 결국 다음과 같은 형태가 됩니다:</p>
<pre><pre class="playground"><code class="language-rust edition2024"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span><span class="boring">#[cfg(any())]
</span>// 우리는 `Vec`을 드롭할 때 `T`를 사용하지 않겠다고 새끼손가락 걸고 약속합니다...
unsafe impl&lt;#[may_dangle] T&gt; Drop for Vec&lt;T&gt; {
    fn drop(&amp;mut self) {
        unsafe {
            if mem::needs_drop::&lt;T&gt;() {
                /* ... 즉, 여기를 제외하고는 말이죠 ... */
                ptr::drop_in_place::&lt;[T]&gt;(/* … */);
            }
            // ...
            dealloc(/* … */)
            // ...
        }
    }
}

struct Vec&lt;T&gt; {
    // ... `Vec`이 `T` 아이템들을 소유하고 있으며
    // 따라서 드롭 시점에 `T` 아이템들을 드롭할 수 있다는 사실만 제외하고 말이죠!
    _owns_T: core::marker::PhantomData&lt;T&gt;,

    ptr: *const T, // 공변성을 위한 `*const` (하지만 이것은 그 자체로 `T`에 대한 소유권을 표현하지는 않습니다)
    len: usize,
    cap: usize,
}
<span class="boring">}</span></code></pre></pre>
</details>
<hr />
<p>할당된 메모리를 소유하는 원시 포인터는 매우 흔한 패턴이어서, 표준 라이브러리는 스스로를 위해 <code>Unique&lt;T&gt;</code>라는 유틸리티를 만들었습니다. 이 유틸리티는 다음과 같은 특징을 가집니다:</p>
<ul>
<li>공변성을 위해 <code>*const T</code>를 감쌉니다</li>
<li><code>PhantomData&lt;T&gt;</code>를 포함합니다</li>
<li>T가 포함된 것처럼 <code>Send</code>/<code>Sync</code>를 자동으로 파생합니다</li>
<li>널 포인터 최적화를 위해 포인터를 <code>NonZero</code>로 표시합니다</li>
</ul>
<h2 id="phantomdata-패턴-표"><a class="header" href="#phantomdata-패턴-표"><code>PhantomData</code> 패턴 표</a></h2>
<p>다음은 <code>PhantomData</code>가 사용될 수 있는 모든 멋진 방법들을 정리한 표입니다:</p>
<div class="table-wrapper"><table><thead><tr><th>팬텀 타입</th><th style="text-align: center"><code>'a</code>의 공변성</th><th style="text-align: center"><code>T</code>의 공변성</th><th style="text-align: center"><code>Send</code>/<code>Sync</code><br/>(혹은 그 결여)</th><th style="text-align: center">드롭 글루에서의 <code>'a</code> 또는 <code>T</code> 댕글링<br/>(예: <code>#[may_dangle] Drop</code>)</th></tr></thead><tbody>
<tr><td><code>PhantomData&lt;T&gt;</code></td><td style="text-align: center">-</td><td style="text-align: center"><strong>공변(covariant)</strong></td><td style="text-align: center">상속됨</td><td style="text-align: center">허용되지 않음 ("<code>T</code>를 소유함")</td></tr>
<tr><td><code>PhantomData&lt;&amp;'a T&gt;</code></td><td style="text-align: center"><strong>공변(covariant)</strong></td><td style="text-align: center"><strong>공변(covariant)</strong></td><td style="text-align: center"><code>Send + Sync</code><br/><code>T : Sync</code> 요구됨</td><td style="text-align: center">허용됨</td></tr>
<tr><td><code>PhantomData&lt;&amp;'a mut T&gt;</code></td><td style="text-align: center"><strong>공변(covariant)</strong></td><td style="text-align: center"><strong>불변(invariant)</strong></td><td style="text-align: center">상속됨</td><td style="text-align: center">허용됨</td></tr>
<tr><td><code>PhantomData&lt;*const T&gt;</code></td><td style="text-align: center">-</td><td style="text-align: center"><strong>공변(covariant)</strong></td><td style="text-align: center"><code>!Send + !Sync</code></td><td style="text-align: center">허용됨</td></tr>
<tr><td><code>PhantomData&lt;*mut T&gt;</code></td><td style="text-align: center">-</td><td style="text-align: center"><strong>불변(invariant)</strong></td><td style="text-align: center"><code>!Send + !Sync</code></td><td style="text-align: center">허용됨</td></tr>
<tr><td><code>PhantomData&lt;fn(T)&gt;</code></td><td style="text-align: center">-</td><td style="text-align: center"><strong>반공변(contravariant)</strong></td><td style="text-align: center"><code>Send + Sync</code></td><td style="text-align: center">허용됨</td></tr>
<tr><td><code>PhantomData&lt;fn() -&gt; T&gt;</code></td><td style="text-align: center">-</td><td style="text-align: center"><strong>공변(covariant)</strong></td><td style="text-align: center"><code>Send + Sync</code></td><td style="text-align: center">허용됨</td></tr>
<tr><td><code>PhantomData&lt;fn(T) -&gt; T&gt;</code></td><td style="text-align: center">-</td><td style="text-align: center"><strong>불변(invariant)</strong></td><td style="text-align: center"><code>Send + Sync</code></td><td style="text-align: center">허용됨</td></tr>
<tr><td><code>PhantomData&lt;Cell&lt;&amp;'a ()&gt;&gt;</code></td><td style="text-align: center"><strong>불변(invariant)</strong></td><td style="text-align: center">-</td><td style="text-align: center"><code>Send + !Sync</code></td><td style="text-align: center">허용됨</td></tr>
</tbody></table>
</div>
<ul>
<li>참고: <code>Unpin</code> 오토 트레잇을 취소(opt out)하려면 대신 전용 타입인 <a href="../core/marker/struct.PhantomPinned.html"><code>PhantomPinned</code></a>이 필요합니다.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="dropck.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="borrow-splitting.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="dropck.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="borrow-splitting.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/language-picker.js"></script>


    </div>
    </body>
</html>
