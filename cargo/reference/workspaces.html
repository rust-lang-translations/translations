<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Workspaces - The Cargo Book</title>


        <!-- Custom HTML head -->
        <style>
            dd {
                margin-bottom: 1em;
            }
        </style>
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-L455DH98TK"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-L455DH98TK');
        </script>
        
        
        <script>
            (function () {
                // See these pages for details:
                // https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls
                // https://developers.google.com/search/docs/crawling-indexing/javascript/javascript-seo-basics
        
                function gen_canonical_href(lang) {
        
                    let base = "https://rust-lang-translations.org/cargo";
        
                    let canonical_href;
                    if (lang == "en") {
                        canonical_href = `${base}/reference/workspaces.md`;
                    } else {
                        canonical_href = `${base}/${lang}/reference/workspaces.md`;
                    }
                    canonical_href = canonical_href.slice(0, -"md".length) + "html";
                    if (canonical_href.endsWith("/index.html")) {
                        canonical_href = canonical_href.slice(0, -"index.html".length);
                    }
                    return canonical_href;
                }
        
                const canonical_href = gen_canonical_href("en");

                let link = document.createElement("link");
                link.rel = "canonical";
                link.href = canonical_href;
                document.head.appendChild(link);
        
        
                const langs = ["en"  , "ja"  , "ko" ];
        
                for (const lang of langs) {
                    const canonical_href = gen_canonical_href(lang);
        
                    let link = document.createElement("link");
                    link.rel = "alternate";
                    link.hreflang = lang;
                    link.href = canonical_href;
                    document.head.appendChild(link);
                }
            })()
        </script>
        

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/language-picker.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Cargo Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang-translations/project" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-lang/cargo/edit/master/src/doc/src/reference/workspaces.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="workspaces"><a class="header" href="#workspaces">Workspaces</a></h1>
<p>A <em>workspace</em> is a collection of one or more packages, called <em>workspace
members</em>, that are managed together.</p>
<p>The key points of workspaces are:</p>
<ul>
<li>Common commands can run across all workspace members, like <code>cargo check --workspace</code>.</li>
<li>All packages share a common <a href="../guide/cargo-toml-vs-cargo-lock.html"><code>Cargo.lock</code></a> file which resides in the
<em>workspace root</em>.</li>
<li>All packages share a common <a href="build-cache.html">output directory</a>, which defaults to a
directory named <code>target</code> in the <em>workspace root</em>.</li>
<li>Sharing package metadata, like with <a href="#the-package-table"><code>workspace.package</code></a>.</li>
<li>The <a href="overriding-dependencies.html#the-patch-section"><code>[patch]</code></a>, <a href="overriding-dependencies.html#the-replace-section"><code>[replace]</code></a> and <a href="profiles.html"><code>[profile.*]</code></a>
sections in <code>Cargo.toml</code> are only recognized in the <em>root</em> manifest, and
ignored in member crates’ manifests.</li>
</ul>
<p>The root <code>Cargo.toml</code> of a workspace supports the following sections:</p>
<ul>
<li><a href="#the-workspace-section"><code>[workspace]</code></a> — Defines a workspace.
<ul>
<li><a href="resolver.html#resolver-versions"><code>resolver</code></a> — Sets the dependency resolver to use.</li>
<li><a href="#the-members-and-exclude-fields"><code>members</code></a> — Packages to include in the workspace.</li>
<li><a href="#the-members-and-exclude-fields"><code>exclude</code></a> — Packages to exclude from the workspace.</li>
<li><a href="#the-default-members-field"><code>default-members</code></a> — Packages to operate on when a specific package wasn’t selected.</li>
<li><a href="#the-package-table"><code>package</code></a> — Keys for inheriting in packages.</li>
<li><a href="#the-dependencies-table"><code>dependencies</code></a> — Keys for inheriting in package dependencies.</li>
<li><a href="#the-lints-table"><code>lints</code></a> — Keys for inheriting in package lints.</li>
<li><a href="#the-metadata-table"><code>metadata</code></a> — Extra settings for external tools.</li>
</ul>
</li>
<li><a href="overriding-dependencies.html#the-patch-section"><code>[patch]</code></a> — Override dependencies.</li>
<li><a href="overriding-dependencies.html#the-replace-section"><code>[replace]</code></a> — Override dependencies (deprecated).</li>
<li><a href="profiles.html"><code>[profile]</code></a> — Compiler settings and optimizations.</li>
</ul>
<h2 id="the-workspace-section"><a class="header" href="#the-workspace-section">The <code>[workspace]</code> section</a></h2>
<p>To create a workspace, you add the <code>[workspace]</code> table to a <code>Cargo.toml</code>:</p>
<pre><code class="language-toml">[workspace]
# ...
</code></pre>
<p>At minimum, a workspace has to have a member, either with a root package or as
a virtual manifest.</p>
<h3 id="root-package"><a class="header" href="#root-package">Root package</a></h3>
<p>If the <a href="#the-workspace-section"><code>[workspace]</code> section</a> is added to a
<code>Cargo.toml</code> that already defines a <code>[package]</code>, the package is
the <em>root package</em> of the workspace. The <em>workspace root</em> is the directory
where the workspace’s <code>Cargo.toml</code> is located.</p>
<pre><code class="language-toml">[workspace]

[package]
name = "hello_world" # the name of the package
version = "0.1.0"    # the current version, obeying semver
</code></pre>
<h3 id="virtual-workspace"><a class="header" href="#virtual-workspace">Virtual workspace</a></h3>
<p>Alternatively, a <code>Cargo.toml</code> file can be created with a <code>[workspace]</code> section
but without a <a href="manifest.html#the-package-section"><code>[package]</code> section</a>. This is called a <em>virtual
manifest</em>. This is typically useful when there isn’t a “primary” package, or
you want to keep all the packages organized in separate directories.</p>
<pre><code class="language-toml"># [PROJECT_DIR]/Cargo.toml
[workspace]
members = ["hello_world"]
resolver = "3"
</code></pre>
<pre><code class="language-toml"># [PROJECT_DIR]/hello_world/Cargo.toml
[package]
name = "hello_world" # the name of the package
version = "0.1.0"    # the current version, obeying semver
edition = "2024"     # the edition, will have no effect on a resolver used in the workspace
</code></pre>
<p>By having a workspace without a root package,</p>
<ul>
<li><a href="resolver.html#resolver-versions"><code>resolver</code></a> must be
set explicitly in virtual workspaces as they have no
<a href="manifest.html#the-edition-field"><code>package.edition</code></a> to infer it from
<a href="resolver.html#resolver-versions">resolver version</a>.</li>
<li>Commands run in the workspace root will run against all workspace
members by default, see <a href="#the-default-members-field"><code>default-members</code></a>.</li>
</ul>
<h2 id="the-members-and-exclude-fields"><a class="header" href="#the-members-and-exclude-fields">The <code>members</code> and <code>exclude</code> fields</a></h2>
<p>The <code>members</code> and <code>exclude</code> fields define which packages are members of
the workspace:</p>
<pre><code class="language-toml">[workspace]
members = ["member1", "path/to/member2", "crates/*"]
exclude = ["crates/foo", "path/to/other"]
</code></pre>
<p>All <a href="specifying-dependencies.html#specifying-path-dependencies"><code>path</code> dependencies</a> residing in the workspace directory automatically
become members. Additional members can be listed with the <code>members</code> key, which
should be an array of strings containing directories with <code>Cargo.toml</code> files.</p>
<p>The <code>members</code> list also supports <a href="https://docs.rs/glob/0.3.0/glob/struct.Pattern.html">globs</a> to match multiple paths, using
typical filename glob patterns like <code>*</code> and <code>?</code>.</p>
<p>The <code>exclude</code> key can be used to prevent paths from being included in a
workspace. This can be useful if some path dependencies aren’t desired to be
in the workspace at all, or using a glob pattern and you want to remove a
directory.</p>
<p>When inside a subdirectory within the workspace, Cargo will automatically
search the parent directories for a <code>Cargo.toml</code> file with a <code>[workspace]</code>
definition to determine which workspace to use. The <a href="manifest.html#the-workspace-field"><code>package.workspace</code></a>
manifest key can be used in member crates to point at a workspace’s root to
override this automatic search. The manual setting can be useful if the member
is not inside a subdirectory of the workspace root.</p>
<h3 id="package-selection"><a class="header" href="#package-selection">Package selection</a></h3>
<p>In a workspace, package-related Cargo commands like <a href="../commands/cargo-build.html"><code>cargo build</code></a> can use
the <code>-p</code> / <code>--package</code> or <code>--workspace</code> command-line flags to determine which
packages to operate on. If neither of those flags are specified, Cargo will
use the package in the current working directory. However, if the current directory is
a workspace root, the <a href="#the-default-members-field"><code>default-members</code></a> will be used.</p>
<h2 id="the-default-members-field"><a class="header" href="#the-default-members-field">The <code>default-members</code> field</a></h2>
<p>The <code>default-members</code> field specifies paths of <a href="#the-members-and-exclude-fields">members</a> to
operate on when in the workspace root and the package selection flags are not
used:</p>
<pre><code class="language-toml">[workspace]
members = ["path/to/member1", "path/to/member2", "path/to/member3/*"]
default-members = ["path/to/member2", "path/to/member3/foo"]
</code></pre>
<blockquote>
<p>Note: when a <a href="#root-package">root package</a> is present,
you can only operate on it using <code>--package</code> and <code>--workspace</code> flags.</p>
</blockquote>
<p>When unspecified, the <a href="#root-package">root package</a> will be used.
In the case of a <a href="#virtual-workspace">virtual workspace</a>, all members will be used
(as if <code>--workspace</code> were specified on the command-line).</p>
<h2 id="the-package-table"><a class="header" href="#the-package-table">The <code>package</code> table</a></h2>
<p>The <code>workspace.package</code> table is where you define keys that can be
inherited by members of a workspace. These keys can be inherited by
defining them in the member package with <code>{key}.workspace = true</code>.</p>
<p>Keys that are supported:</p>
<div class="table-wrapper"><table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><code>authors</code></td><td><code>categories</code></td></tr>
<tr><td><code>description</code></td><td><code>documentation</code></td></tr>
<tr><td><code>edition</code></td><td><code>exclude</code></td></tr>
<tr><td><code>homepage</code></td><td><code>include</code></td></tr>
<tr><td><code>keywords</code></td><td><code>license</code></td></tr>
<tr><td><code>license-file</code></td><td><code>publish</code></td></tr>
<tr><td><code>readme</code></td><td><code>repository</code></td></tr>
<tr><td><code>rust-version</code></td><td><code>version</code></td></tr>
</tbody></table>
</div>
<ul>
<li><code>license-file</code> and <code>readme</code> are relative to the workspace root</li>
<li><code>include</code> and <code>exclude</code> are relative to your package root</li>
</ul>
<p>Example:</p>
<pre><code class="language-toml"># [PROJECT_DIR]/Cargo.toml
[workspace]
members = ["bar"]

[workspace.package]
version = "1.2.3"
authors = ["Nice Folks"]
description = "A short description of my package"
documentation = "https://example.com/bar"
</code></pre>
<pre><code class="language-toml"># [PROJECT_DIR]/bar/Cargo.toml
[package]
name = "bar"
version.workspace = true
authors.workspace = true
description.workspace = true
documentation.workspace = true
</code></pre>
<blockquote>
<p><strong>MSRV:</strong> Requires 1.64+</p>
</blockquote>
<h2 id="the-dependencies-table"><a class="header" href="#the-dependencies-table">The <code>dependencies</code> table</a></h2>
<p>The <code>workspace.dependencies</code> table is where you define dependencies to be
inherited by members of a workspace.</p>
<p>Specifying a workspace dependency is similar to <a href="specifying-dependencies.html">package dependencies</a> except:</p>
<ul>
<li>Dependencies from this table cannot be declared as <code>optional</code></li>
<li><a href="features.html"><code>features</code></a> declared in this table are additive with the <code>features</code> from <code>[dependencies]</code></li>
</ul>
<p>You can then <a href="specifying-dependencies.html#inheriting-a-dependency-from-a-workspace">inherit the workspace dependency as a package dependency</a></p>
<p>Example:</p>
<pre><code class="language-toml"># [PROJECT_DIR]/Cargo.toml
[workspace]
members = ["bar"]

[workspace.dependencies]
cc = "1.0.73"
rand = "0.8.5"
regex = { version = "1.6.0", default-features = false, features = ["std"] }
</code></pre>
<pre><code class="language-toml"># [PROJECT_DIR]/bar/Cargo.toml
[package]
name = "bar"
version = "0.2.0"

[dependencies]
regex = { workspace = true, features = ["unicode"] }

[build-dependencies]
cc.workspace = true

[dev-dependencies]
rand.workspace = true
</code></pre>
<blockquote>
<p><strong>MSRV:</strong> Requires 1.64+</p>
</blockquote>
<h2 id="the-lints-table"><a class="header" href="#the-lints-table">The <code>lints</code> table</a></h2>
<p>The <code>workspace.lints</code> table is where you define lint configuration to be inherited by members of a workspace.</p>
<p>Specifying a workspace lint configuration is similar to <a href="manifest.html#the-lints-section">package lints</a>.</p>
<p>Example:</p>
<pre><code class="language-toml"># [PROJECT_DIR]/Cargo.toml
[workspace]
members = ["crates/*"]

[workspace.lints.rust]
unsafe_code = "forbid"
</code></pre>
<pre><code class="language-toml"># [PROJECT_DIR]/crates/bar/Cargo.toml
[package]
name = "bar"
version = "0.1.0"

[lints]
workspace = true
</code></pre>
<blockquote>
<p><strong>MSRV:</strong> Respected as of 1.74</p>
</blockquote>
<h2 id="the-metadata-table"><a class="header" href="#the-metadata-table">The <code>metadata</code> table</a></h2>
<p>The <code>workspace.metadata</code> table is ignored by Cargo and will not be warned
about. This section can be used for tools that would like to store workspace
configuration in <code>Cargo.toml</code>. For example:</p>
<pre><code class="language-toml">[workspace]
members = ["member1", "member2"]

[workspace.metadata.webcontents]
root = "path/to/webproject"
tool = ["npm", "run", "build"]
# ...
</code></pre>
<p>There is a similar set of tables at the package level at
<a href="manifest.html#the-metadata-table"><code>package.metadata</code></a>. While cargo does not specify a
format for the content of either of these tables, it is suggested that
external tools may wish to use them in a consistent fashion, such as referring
to the data in <code>workspace.metadata</code> if data is missing from <code>package.metadata</code>,
if that makes sense for the tool in question.</p>
<script>
(function() {
    var fragments = {
        "#virtual-manifest": "workspaces.html#virtual-workspace",
    };
    var target = fragments[window.location.hash];
    if (target) {
        var url = window.location.toString();
        var base = url.substring(0, url.lastIndexOf('/'));
        window.location.replace(base + "/" + target);
    }
})();
</script>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../reference/rust-version.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../reference/specifying-dependencies.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../reference/rust-version.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../reference/specifying-dependencies.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/language-picker.js"></script>


    </div>
    </body>
</html>
