<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Features Examples - The Cargo Book</title>


        <!-- Custom HTML head -->
        <style>
            dd {
                margin-bottom: 1em;
            }
        </style>
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-L455DH98TK"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-L455DH98TK');
        </script>
        
        
        <script>
            (function () {
                // See these pages for details:
                // https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls
                // https://developers.google.com/search/docs/crawling-indexing/javascript/javascript-seo-basics
        
                function gen_canonical_href(lang) {
        
                    let base = "https://rust-lang-translations.org/cargo";
        
                    let canonical_href;
                    if (lang == "en") {
                        canonical_href = `${base}/reference/features-examples.md`;
                    } else {
                        canonical_href = `${base}/${lang}/reference/features-examples.md`;
                    }
                    canonical_href = canonical_href.slice(0, -"md".length) + "html";
                    if (canonical_href.endsWith("/index.html")) {
                        canonical_href = canonical_href.slice(0, -"index.html".length);
                    }
                    return canonical_href;
                }
        
                const canonical_href = gen_canonical_href("en");

                let link = document.createElement("link");
                link.rel = "canonical";
                link.href = canonical_href;
                document.head.appendChild(link);
        
        
                const langs = ["en"  , "ja" ];
        
                for (const lang of langs) {
                    const canonical_href = gen_canonical_href(lang);
        
                    let link = document.createElement("link");
                    link.rel = "alternate";
                    link.hreflang = lang;
                    link.href = canonical_href;
                    document.head.appendChild(link);
                }
            })()
        </script>
        

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../theme/language-picker.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Cargo Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-lang-translations/project" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-lang/cargo/edit/master/src/doc/src/reference/features-examples.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="features-examples"><a class="header" href="#features-examples">Features Examples</a></h1>
<p>The following illustrates some real-world examples of features in action.</p>
<h2 id="minimizing-build-times-and-file-sizes"><a class="header" href="#minimizing-build-times-and-file-sizes">Minimizing build times and file sizes</a></h2>
<p>Some packages use features so that if the features are not enabled, it reduces
the size of the crate and reduces compile time. Some examples are:</p>
<ul>
<li><a href="https://crates.io/crates/syn"><code>syn</code></a> is a popular crate for parsing Rust code. Since it is so popular, it
is helpful to reduce compile times since it affects so many projects. It has
a <a href="https://docs.rs/syn/1.0.54/syn/#optional-features">clearly documented list</a> of features which can be used to
minimize the amount of code it contains.</li>
<li><a href="https://crates.io/crates/regex"><code>regex</code></a> has a <a href="https://github.com/rust-lang/regex/blob/1.4.2/Cargo.toml#L33-L101">several features</a> that are <a href="https://docs.rs/regex/1.4.2/regex/#crate-features">well
documented</a>. Cutting out Unicode support can reduce the
resulting file size as it can remove some large tables.</li>
<li><a href="https://crates.io/crates/winapi"><code>winapi</code></a> has <a href="https://github.com/retep998/winapi-rs/blob/0.3.9/Cargo.toml#L25-L431">a large number</a> of features that
limit which Windows API bindings it supports.</li>
<li><a href="https://crates.io/crates/web-sys"><code>web-sys</code></a> is another example similar to <code>winapi</code> that provides a <a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/crates/web-sys/Cargo.toml#L32-L1395">huge
surface area</a> of API bindings that are limited by using
features.</li>
</ul>
<h2 id="extending-behavior"><a class="header" href="#extending-behavior">Extending behavior</a></h2>
<p>The <a href="https://crates.io/crates/serde_json"><code>serde_json</code></a> package has a <a href="https://github.com/serde-rs/json/blob/v1.0.60/Cargo.toml#L53-L56"><code>preserve_order</code> feature</a>
which <a href="https://github.com/serde-rs/json/blob/v1.0.60/src/map.rs#L23-L26">changes the behavior</a> of JSON maps to preserve the
order that keys are inserted. Notice that it enables an optional dependency
<a href="https://crates.io/crates/indexmap"><code>indexmap</code></a> to implement the new behavior.</p>
<p>When changing behavior like this, be careful to make sure the changes are
<a href="features.html#semver-compatibility">SemVer compatible</a>. That is, enabling the feature should not break code that
usually builds with the feature off.</p>
<h2 id="no_std-support"><a class="header" href="#no_std-support"><code>no_std</code> support</a></h2>
<p>Some packages want to support both <a href="../../reference/names/preludes.html#the-no_std-attribute"><code>no_std</code></a> and <code>std</code> environments. This is
useful for supporting embedded and resource-constrained platforms, but still
allowing extended capabilities for platforms that support the full standard
library.</p>
<p>The <a href="https://crates.io/crates/wasm-bindgen"><code>wasm-bindgen</code></a> package defines a <a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/Cargo.toml#L25"><code>std</code> feature</a> that
is <a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/Cargo.toml#L23">enabled by default</a>. At the top of the library, it
<a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/src/lib.rs#L8">unconditionally enables the <code>no_std</code> attribute</a>. This
ensures that <code>std</code> and the <a href="../../std/prelude/index.html"><code>std</code> prelude</a> are not automatically in scope.
Then, in various places in the code (<a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/src/lib.rs#L270-L273">example1</a>,
<a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/src/lib.rs#L67-L75">example2</a>), it uses <code>#[cfg(feature = "std")]</code> attributes
to conditionally enable extra functionality that requires <code>std</code>.</p>
<h2 id="re-exporting-dependency-features"><a class="header" href="#re-exporting-dependency-features">Re-exporting dependency features</a></h2>
<p>It can be convenient to re-export the features from a dependency. This allows
the user depending on the crate to control those features without needing to
specify those dependencies directly. For example, <a href="https://crates.io/crates/regex"><code>regex</code></a> <a href="https://github.com/rust-lang/regex/blob/1.4.2/Cargo.toml#L65-L89">re-exports the
features</a> from the <a href="https://github.com/rust-lang/regex/blob/1.4.2/regex-syntax/Cargo.toml#L17-L32"><code>regex_syntax</code></a>
package. Users of <code>regex</code> don’t need to know about the <code>regex_syntax</code> package,
but they can still access the features it contains.</p>
<h2 id="vendoring-of-c-libraries"><a class="header" href="#vendoring-of-c-libraries">Vendoring of C libraries</a></h2>
<p>Some packages provide bindings to common C libraries (sometimes referred to as
<a href="build-scripts.html#-sys-packages">“sys” crates</a>). Sometimes these packages give you the choice to use the
C library installed on the system, or to build it from source. For example,
the <a href="https://crates.io/crates/openssl"><code>openssl</code></a> package has a <a href="https://github.com/sfackler/rust-openssl/blob/openssl-v0.10.31/openssl/Cargo.toml#L19"><code>vendored</code> feature</a> which
enables the corresponding <code>vendored</code> feature of <a href="https://crates.io/crates/openssl-sys"><code>openssl-sys</code></a>. The
<code>openssl-sys</code> build script has some <a href="https://github.com/sfackler/rust-openssl/blob/openssl-v0.10.31/openssl-sys/build/main.rs#L47-L54">conditional logic</a> which
causes it to build from a local copy of the OpenSSL source code instead of
using the version from the system.</p>
<p>The <a href="https://crates.io/crates/curl-sys"><code>curl-sys</code></a> package is another example where the <a href="https://github.com/alexcrichton/curl-rust/blob/0.4.34/curl-sys/Cargo.toml#L49"><code>static-curl</code>
feature</a> causes it to build libcurl from source. Notice that
it also has a <a href="https://github.com/alexcrichton/curl-rust/blob/0.4.34/curl-sys/Cargo.toml#L52"><code>force-system-lib-on-osx</code></a> feature which forces
it <a href="https://github.com/alexcrichton/curl-rust/blob/0.4.34/curl-sys/build.rs#L15-L20">to use the system libcurl</a>, overriding the
static-curl setting.</p>
<h2 id="feature-precedence"><a class="header" href="#feature-precedence">Feature precedence</a></h2>
<p>Some packages may have mutually-exclusive features. One option to handle this
is to prefer one feature over another. The <a href="https://crates.io/crates/log"><code>log</code></a> package is an example. It
has <a href="https://github.com/rust-lang/log/blob/0.4.11/Cargo.toml#L29-L42">several features</a> for choosing the maximum logging level at
compile-time described <a href="https://docs.rs/log/0.4.11/log/#compile-time-filters">here</a>. It uses <a href="https://crates.io/crates/cfg-if"><code>cfg-if</code></a> to <a href="https://github.com/rust-lang/log/blob/0.4.11/src/lib.rs#L1422-L1448">choose a
precedence</a>. If multiple features are enabled, the higher “max”
levels will be preferred over the lower levels.</p>
<h2 id="proc-macro-companion-package"><a class="header" href="#proc-macro-companion-package">Proc-macro companion package</a></h2>
<p>Some packages have a proc-macro that is intimately tied with it. However, not
all users will need to use the proc-macro. By making the proc-macro an
optional-dependency, this allows you to conveniently choose whether or not it
is included. This is helpful, because sometimes the proc-macro version must
stay in sync with the parent package, and you don’t want to force the users to
have to specify both dependencies and keep them in sync.</p>
<p>An example is <a href="https://crates.io/crates/serde"><code>serde</code></a> which has a <a href="https://github.com/serde-rs/serde/blob/v1.0.118/serde/Cargo.toml#L34-L35"><code>derive</code></a> feature which
enables the <a href="https://crates.io/crates/serde_derive"><code>serde_derive</code></a> proc-macro. The <code>serde_derive</code> crate is very
tightly tied to <code>serde</code>, so it uses an <a href="https://github.com/serde-rs/serde/blob/v1.0.118/serde/Cargo.toml#L17">equals version
requirement</a> to ensure they stay in sync.</p>
<h2 id="nightly-only-features"><a class="header" href="#nightly-only-features">Nightly-only features</a></h2>
<p>Some packages want to experiment with APIs or language features that are only
available on the Rust <a href="../../book/appendix-07-nightly-rust.html">nightly channel</a>. However, they may not want to require
their users to also use the nightly channel. An example is <a href="https://crates.io/crates/wasm-bindgen"><code>wasm-bindgen</code></a>
which has a <a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/Cargo.toml#L27"><code>nightly</code> feature</a> which enables an
<a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/src/closure.rs#L257-L269">extended API</a> that uses the <a href="../../std/marker/trait.Unsize.html"><code>Unsize</code></a> marker trait that
is only available on the nightly channel at the time of this writing.</p>
<p>Note that at the root of the crate it uses <a href="https://github.com/rustwasm/wasm-bindgen/blob/0.2.69/src/lib.rs#L11"><code>cfg_attr</code> to enable the nightly
feature</a>. Keep in mind that the <a href="../../unstable-book/index.html"><code>feature</code> attribute</a>
is unrelated to Cargo features, and is used to opt-in to experimental language
features.</p>
<p>The <a href="https://github.com/rust-random/rand/blob/0.7.3/Cargo.toml#L40"><code>simd_support</code> feature</a> of the <a href="https://crates.io/crates/rand"><code>rand</code></a> package is another example,
which relies on a dependency that only builds on the nightly channel.</p>
<h2 id="experimental-features"><a class="header" href="#experimental-features">Experimental features</a></h2>
<p>Some packages have new functionality that they may want to experiment with,
without having to commit to the stability of those APIs. The features are
usually documented that they are experimental, and thus may change or break in
the future, even during a minor release. An example is the <a href="https://crates.io/crates/async-std"><code>async-std</code></a>
package, which has an <a href="https://github.com/async-rs/async-std/blob/v1.8.0/Cargo.toml#L38-L42"><code>unstable</code> feature</a>, which <a href="https://github.com/async-rs/async-std/blob/v1.8.0/src/macros.rs#L46">gates
new APIs</a> that people can opt-in to using, but may not be
completely ready to be relied upon.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../reference/features.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../reference/profiles.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../reference/features.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../reference/profiles.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../theme/language-picker.js"></script>


    </div>
    </body>
</html>
